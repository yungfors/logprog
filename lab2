domains
    status = string.

predicates
    товар(integer, string, string, integer).
    клиент(string, string).
    покупка(string, integer, integer, string).
    постоянный(string).
    сумма_покупок(string, string, integer).
    статус_клиента(string, status).

clauses
    товар(1, "Футболка", "Одежда", 1000).
    товар(2, "Ноутбук", "Электроника", 50000).
    товар(3, "Стул", "Мебель", 3000).
    товар(4, "Телевизор", "Электроника", 25000).
    товар(5, "Ручка", "Канцелярия", 50).
    товар(6, "Тетрадь", "Канцелярия", 100).
    товар(7, "Ковер", "Мебель", 15000).
    товар(8, "Книга", "Литература", 800).
    товар(9, "Коврик", "Мебель", 2000).
    товар(10, "Часы", "Аксессуары", 10000).

    клиент("Иванов Иван Иванович", "89991234567").
    клиент("Сидорова Анна Петровна", "89997894532").
    клиент("Петров Петр Петрович", "89991111111").
    клиент("Козлов Андрей Игоревич", "89992222222").
    клиент("Сергеева Оксана Владимировна", "89993333333").
    клиент("Белов Максим Александрович", "89994444444").
    клиент("Лебедева Екатерина Сергеевна", "89995555555").

    покупка("89991234567", 1, 2, "20.05.2021").
    покупка("89997894532", 3, 1, "19.05.2021").
    покупка("89991111111", 5, 10, "19.05.2021").
    покупка("89994444444", 2, 1, "21.05.2021").
    покупка("89994444444", 4, 1, "21.05.2021").
    покупка("89993333333", 6, 5, "20.05.2021").
    покупка("89993333333", 7, 1, "20.05.2021").
    покупка("89993333333", 8, 2, "21.05.2021").
    покупка("89995555555", 9, 1, "22.05.2021").
    покупка("89991234567", 10, 3, "23.05.2021").

    постоянный(Телефон) :-
        покупка(Телефон, _, _, _),
        not(покупка(Телефон, _, _, Дата1)),
        not((покупка(Телефон, _, _, Дата2), Дата2 < Дата1)).

    сумма_покупок(Телефон, Дата, Сумма) :-
        findall(КоличествоТовара * Цена,
                покупка(Телефон, ID, КоличествоТовара, Дата), Список),
        maplist(plus, Список, Сумма_по_товарам),
        sum_list(Сумма_по_товарам, Сумма).

    статус_клиента(Телефон, "Новый клиент") :-
        покупка(Телефон, _, _, _),
        not(постоянный(Телефон)),
        сумма_покупок(Телефон, _, Сумма),
        Сумма < 10000.
    статус_клиента(Телефон, "Стандартный клиент") :-
        постоянный(Телефон),
        сумма_покупок(Телефон, _, Сумма),
        Сумма < 50000.
    статус_клиента(Телефон, "VIP-клиент") :-
        постоянный(Телефон),
        сумма_покупок(Телефон, _, Сумма),
        Сумма >= 50000.

goal
    clausesFromFile("queries.txt"). 

    % запрос: имена всех клиентов , купивших определенный товар
    % ?- покупка(Телефон, ID, КоличествоТовара, Дата), товар(ID, "Футболка", _, _), клиент(Имя, Телефон).
    % ответ:
    % Имя = "Иванов Иван Иванович"
    % Телефон = "89991234567"

    % запрос: названия всех товаров , проданных в определенный день
    % ?- покупка(_, ID, КоличествоТовара, "20.05.2021"), товар(ID, Название, _, _).
    % ответ:
    % Название = "Футболка"
    % Название = "Тетрадь"
    % Название = "Ковер"

    % запрос: статус клиента по его номеру телефона
    % ?- статус_клиента("89995555555", Статус).
    % ответ:
    % Статус = "Новый клиент".
